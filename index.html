<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BrainLab â€“ ×—×§×¨ ×”××•×— ×œ×™×œ×“×™× ×•×œ××‘×•×’×¨×™×</title>
    <!-- <link rel="stylesheet" href="theme-01-ocean.css"> -->
    <!-- <link rel="stylesheet" href="./theme-02-forest.css"> -->
    <link rel="stylesheet" href="./theme-03-sunset.css">
    <!-- <link rel="stylesheet" href="theme-03-light.css"> -->

    <!-- ×ª×¦×•×’×” ×‘×œ×™ ×¢×™×¦×•×‘ -->
    <style>
        :root {
            --bg: #0f1226;
            --panel: #171a34;
            --muted: #8187a7;
            --text: #e9ecff;
            --accent: #7aa2ff;
            --accent2: #00e1d6;
            --card: #1e2247;
            --ok: #43d787;
            --warn: #ffd166;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            font-family: "Rubik", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Helvetica, Arial, sans-serif;
            background: radial-gradient(1200px 800px at 75% -10%, #1f2553 0%, #0f1226 60%), #0f1226;
            color: var(--text);
        }

        a {
            color: var(--accent)
        }

        .wrap {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 100dvh
        }

        .sidebar {
            background: linear-gradient(180deg, #171a34 0%, #101330 100%);
            border-inline-start: 1px solid #232853;
            padding: 20px;
            position: sticky;
            top: 0;
            height: 100dvh;
            overflow: auto
        }

        .main {
            padding: 24px;
        }

        h1 {
            font-size: clamp(26px, 3vw, 40px);
            display: flex;
            align-items: center;
            gap: .5rem;
            margin: 0 0 8px
        }

        .subtitle {
            color: var(--muted);
            margin: 0 0 20px
        }

        .badge {
            display: inline-flex;
            gap: .4rem;
            align-items: center;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            padding: 6px 10px;
            border-radius: 999px;
            color: #0a1022;
            font-weight: 700
        }

        /* Controls */
        .panel {
            background: var(--panel);
            border: 1px solid #262b59;
            border-radius: 16px;
            padding: 12px;
            margin-bottom: 16px
        }

        .panel h3 {
            margin: 0 0 10px;
            font-size: 16px;
            color: #c9d2ff
        }

        .btn {
            border: 1px solid #2a3168;
            background: #0f132e;
            color: var(--text);
            padding: 8px 10px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600
        }

        .btn[aria-pressed="true"],
        .btn.active {
            background: linear-gradient(180deg, #262c63, #1a1e4a);
            border-color: #3e4793;
            box-shadow: 0 0 0 2px rgba(122, 162, 255, .25) inset
        }

        .btn.small {
            font-size: 12px;
            padding: 6px 8px
        }

        .btn.ghost {
            background: transparent
        }

        .grid {
            display: grid;
            gap: 14px
        }

        .grid.cols-2 {
            grid-template-columns: repeat(2, 1fr)
        }

        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px
        }

        .lvl {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px
        }

        .search {
            display: flex;
            gap: 8px
        }

        .search input {
            flex: 1;
            border: 1px solid #303675;
            background: #0e1332;
            color: var(--text);
            padding: 10px 12px;
            border-radius: 10px
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            flex-wrap: wrap
        }

        .tab {
            padding: 10px 12px;
            border: 1px solid #2a3168;
            border-radius: 12px;
            background: #111642;
            color: #dfe5ff;
            cursor: pointer;
            font-weight: 700
        }

        .tab[aria-selected="true"] {
            background: linear-gradient(180deg, #242a62, #171c4b);
            border-color: #3e4793;
        }

        /* Cards */
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 16px;
            margin-top: 16px
        }

        .card {
            background: linear-gradient(180deg, #1b1f46, #13173b);
            border: 1px solid #2b3065;
            border-radius: 18px;
            padding: 14px;
            /* ×¨×™×•×•×— ×¢×œ×™×•×Ÿ × ×•×¡×£ ×›×“×™ ×œ×× ×•×¢ ×—×¤×™×¤×” ×©×œ ×”-pill ×¢× ×”×›×•×ª×¨×ª */
            padding-top: 44px;
            position: relative;
            overflow: hidden
        }

        .card h4 {
            margin: 0 0 6px
        }

        .card p {
            margin: 0;
            color: #cdd3ff
        }

        .pill {
            position: absolute;
            inset-inline-start: 12px;
            top: 12px;
            background: #10153e;
            border: 1px solid #2c3170;
            color: #a9b3ff;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 999px
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 10px
        }

        .tag {
            font-size: 11px;
            border: 1px dashed #3d4390;
            border-radius: 999px;
            padding: 3px 8px;
            color: #aeb7ff
        }

        .kiosk {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 16px
        }

        /* Brain map */
        .map {
            background: radial-gradient(800px 400px at 60% -20%, rgba(122, 162, 255, .15), transparent 60%), #14183a;
            border: 1px solid #2a3168;
            border-radius: 16px;
            padding: 12px
        }

        .brain {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-auto-rows: 50px;
            gap: 6px
        }

        .cell {
            border: 1px solid #384096;
            background: linear-gradient(180deg, #20265b, #171c46);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #cfe1ff;
            cursor: pointer;
            user-select: none
        }

        .cell.active {
            outline: 2px solid var(--accent);
            box-shadow: 0 0 0 3px rgba(122, 162, 255, .25)
        }

        /* Drawer / modal */
        dialog {
            border: none;
            border-radius: 16px;
            padding: 0;
            background: #151a3d;
            color: var(--text);
            width: min(680px, 95vw)
        }

        .dialog-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            border-bottom: 1px solid #2b3065
        }

        .dialog-body {
            padding: 16px
        }

        /* Footer */
        footer {
            margin-top: 28px;
            color: #9aa1c9;
            font-size: 13px
        }

        @media (max-width: 960px) {
            .wrap {
                grid-template-columns: 1fr
            }

            .sidebar {
                position: static;
                height: auto
            }
        }
    </style>
</head>

<body>
    <div class="wrap">
        <!-- SIDEBAR -->
        <aside class="sidebar" aria-label="×¡×¨×’×œ ×¦×“">
            <div class="panel">
                <h3>ğŸ¯ ×¨××ª ×§×”×œ ×”×™×¢×“</h3>
                <div class="lvl">
                    <button class="btn small" data-level="kids">ğŸ‘¶ ×’×Ÿ</button>
                    <button class="btn small" data-level="elem">ğŸ§’ ×™×¡×•×“×™</button>
                    <button class="btn small" data-level="teen">ğŸ§‘â€ğŸ“ ×—×˜"×‘/×ª×™×›×•×Ÿ</button>
                    <button class="btn small" data-level="pro">ğŸ§ª ×—×•×§×¨</button>
                </div>
            </div>
            <div class="panel">
                <h3>ğŸ” ×—×™×¤×•×©</h3>
                <div class="search">
                    <input id="q" type="search" placeholder="×—×¤×©/×™ ×ª××™×, ××–×•×¨×™×, ××•×©×’×™×â€¦" aria-label="×—×™×¤×•×©" />
                    <button class="btn" id="clear">× ×™×§×•×™</button>
                </div>
            </div>
            <div class="panel">
                <h3>ğŸ§¬ ×¡×™× ×•× ×™×</h3>
                <div class="chips" id="filters">
                    <button class="btn small" data-filter="neurons">× ×•×™×¨×•× ×™×</button>
                    <button class="btn small" data-filter="glia">×’×œ×™×”</button>
                    <button class="btn small" data-filter="astro">××¡×˜×¨×•×¦×™×˜×™×</button>
                    <button class="btn small" data-filter="oligo">××•×œ×™×’×•×“× ×“×¨×•×¦×™×˜×™×</button>
                    <button class="btn small" data-filter="micro">××™×§×¨×•×’×œ×™×”</button>
                    <button class="btn small" data-filter="brainstem">×’×–×¢ ×”××•×—</button>
                    <button class="btn small" data-filter="cortex">×§×œ×™×¤×ª ×”××•×—</button>
                    <button class="btn small" data-filter="cerebellum">××•×—×•×Ÿ</button>
                    <button class="btn small" data-filter="hipp">×”×™×¤×•×§××¤×•×¡</button>
                    <button class="btn small" data-filter="amyg">×××™×’×“×œ×”</button>
                </div>
            </div>
            <div class="panel">
                <h3>ğŸ§ª × ×™×¡×•×™×™× ×‘×˜×•×—×™× ×‘×‘×™×ª</h3>
                <div class="grid">
                    <button class="btn ghost small" data-open="exps">ğŸ‘‚ ×¨×¤×œ×§×¡×™× ×¤×©×•×˜×™×</button>
                    <button class="btn ghost small" data-open="exps">ğŸ‘ƒ ×˜×¢×™××•×ª ×•×¨×™×—×•×ª</button>
                    <button class="btn ghost small" data-open="exps">ğŸ–ï¸ ××™×©×•×© ×•×©×™×•×•×™ ××©×§×œ</button>
                </div>
            </div>
            <div class="panel">
                <h3>ğŸ“š ××™×œ×•×Ÿ ××•×©×’×™×</h3>
                <button class="btn" data-open="gloss">×¤×ª×— ××™×œ×•×Ÿ</button>
            </div>
        </aside>

        <!-- MAIN -->
        <main class="main" aria-live="polite">
            <header>
                <h1>ğŸ§  BrainLab â€“ ×—×§×¨ ×”××•×—</h1>
                <p class="subtitle">××ª×¨ ×œ×™××•×“×™ ×¢× ×”×¡×‘×¨×™× ×‘×©×œ×‘×™× ×œ×›×œ ×’×™×œ, ×¡×¨×’×œ×™× ×™×“×™×“×•×ª×™×™×, ×•××¤×ª ××•×— ××™× ×˜×¨××§×˜×™×‘×™×ª. <span
                        class="badge">×—×“×©! ××¦×‘ ×™×œ×“×™× ğŸ‘¶</span></p>
            </header>

            <!-- Tabs -->
            <nav class="tabs" role="tablist" aria-label="×›×¨×˜×™×¡×™×•×ª ×ª×•×›×Ÿ">
                <button class="tab" role="tab" aria-selected="true" data-tab="cells">ğŸ§« ×ª××™×</button>
                <button class="tab" role="tab" aria-selected="false" data-tab="regions">ğŸ—ºï¸ ××–×•×¨×™×</button>
                <button class="tab" role="tab" aria-selected="false" data-tab="systems">ğŸ”— ××¢×¨×›×•×ª</button>
                <button class="tab" role="tab" aria-selected="false" data-tab="activities">ğŸ² ×¤×¢×™×œ×•×™×•×ª</button>
            </nav>

            <!-- Content placeholder -->
            <section id="content"></section>

            <!-- Brain map (regions tab extra) -->
            <section id="mapWrap" class="map" hidden>
                <h3>ğŸ§  ××¤×ª ××•×— ××™× ×˜×¨××§×˜×™×‘×™×ª</h3>
                <div class="brain" id="brainGrid" aria-label="××¤×ª ×”××•×—">
                    <div class="cell" data-region="frontal">××•× ×” ××¦×—×™×ª</div>
                    <div class="cell" data-region="parietal">××•× ×” ×§×•×“×§×•×“×™×ª</div>
                    <div class="cell" data-region="temporal">××•× ×” ×¨×§×ª×™×ª</div>
                    <div class="cell" data-region="occipital">××•× ×” ×¢×•×¨×¤×™×ª</div>
                    <div class="cell" data-region="cerebellum">××•×—×•×Ÿ</div>
                    <div class="cell" data-region="brainstem">×’×–×¢ ×”××•×—</div>
                </div>
            </section>

            <footer>
                × ×‘× ×” ×‘××”×‘×” ×œ×—×§×¨ ×”××•×— â€“ ×ª×•×›×Ÿ ×—×™× ×•×›×™ ×‘×©×œ×‘×™× ğŸ‘¶ğŸ§’ğŸ§‘â€ğŸ“ğŸ§ª | ×˜×™×¤: × ×¡×• ×œ×©× ×•×ª ×¨××ª ×’×™×œ ×•×¨×•××™× ×©×”×”×¡×‘×¨×™× ××ª×¢×“× ×™×.
            </footer>
        </main>
    </div>

    <!-- Dialogs -->
    <dialog id="dlgGloss">
        <div class="dialog-head">
            <strong>ğŸ“š ××™×œ×•×Ÿ ××•×©×’×™×</strong>
            <button class="btn small" data-close>×¡×’×™×¨×”</button>
        </div>
        <div class="dialog-body" id="glossBody"></div>
    </dialog>

    <dialog id="dlgExps">
        <div class="dialog-head">
            <strong>ğŸ§ª × ×™×¡×•×™×™× ×‘×˜×•×—×™×</strong>
            <button class="btn small" data-close>×¡×’×™×¨×”</button>
        </div>
        <div class="dialog-body" id="expsBody"></div>
    </dialog>

    <script>
        // ---------- DATA ----------
        const LEVELS = ["kids", "elem", "teen", "pro"]; // ×¡×“×¨ ×¢×•×œ×”

        const cells = [
            {
                id: "neuron", kind: ["neurons"], title: "× ×•×™×¨×•×Ÿ (×ª× ×¢×¦×‘) ğŸ§ âš¡",
                tags: ["×“× ×“×¨×™×˜×™×", "××§×¡×•×Ÿ", "×¡×™× ×¤×¡×”"],
                text: {
                    kids: "×”×ª× ×©×©×•×œ×— ×”×•×“×¢×•×ª ×§×˜× ×˜× ×•×ª ×‘×’×•×£ â€“ ×›××• ×©×œ×™×—×™× ×¢× ×‘×¨×§×™×.",
                    elem: "×ª× ×©××¢×‘×™×¨ ××•×ª×•×ª ×—×©××œ×™×™× ×•×›×™××™×™×. ×™×© ×œ×• ×“× ×“×¨×™×˜×™× ×œ×§×œ×™×˜×” ×•××§×¡×•×Ÿ ×œ×©×œ×™×—×”.",
                    teen: "× ×•×™×¨×•×Ÿ ×™×•×¦×¨ ×¤×•×˜× ×¦×™××œ ×¤×¢×•×œ×” ×•××ªÖ´×§×©×¨ ×“×¨×š ×¡×™× ×¤×¡×•×ª ×‘×¢×–×¨×ª × ×•×™×¨×•×˜×¨× ×¡××™×˜×¨×™×.",
                    pro: "×ª× ××¢×•×¨×¨/××¢×›×‘ ×”××©×œ×‘ ×§×œ×˜×™× ×¡×™× ×¤×˜×™×™× ×œ×—×™×©×•×‘ ×¡×£; ×”×•×œ×›×” ××œ×—×™×ª ×œ××•×¨×š ××§×¡×•×Ÿ ×¢×˜×•×£ ××™××œ×™×Ÿ."
                }
            },
            {
                id: "astro", kind: ["glia", "astro"], title: "××¡×˜×¨×•×¦×™×˜ â­",
                tags: ["×ª××™×›×”", "×ª×–×•× ×”", "×“×-××•×—"],
                text: {
                    kids: "×ª××™ ×¢×–×¨×” ×©×××›×™×œ×™× ×•×©×•××¨×™× ×¢×œ ×”× ×•×™×¨×•× ×™×.",
                    elem: "×©×•××¨×™× ×¢×œ ×¡×‘×™×‘×” ×›×™××™×ª × ×›×•× ×” ×•××¡×™×™×¢×™× ×‘×—×•××ª ×“×-××•×—.",
                    teen: "××¡×œ×§×™× × ×•×™×¨×•×˜×¨× ×¡××™×˜×¨×™×, ×××–× ×™× ×™×•× ×™×, ×•×ª×•×¨××™× ×œ×¤×œ×¡×˜×™×•×ª ×¡×™× ×¤×˜×™×ª.",
                    pro: "××¡×˜×¨×•×¦×™×˜×™× ××‘×˜××™× GFAP; ×¨×’×•×œ×¦×™×™×ª K+ ×•×”×˜×¨×•-×¡×™× ×¤×˜×™×§ ××•×“×•×œ×¦×™×” ×“×¨×š ×˜×¨×™×¤××¨×˜×™×˜ ×¡×™× ×¤×¡."
                }
            },
            {
                id: "oligo", kind: ["glia", "oligo"], title: "××•×œ×™×’×•×“× ×“×¨×•×¦×™×˜ ğŸ§²",
                tags: ["××™××œ×™×Ÿ", "××”×™×¨×•×ª"],
                text: {
                    kids: "××œ×‘×™×© ××ª ×›×‘×œ×™ ×”×¢×¦×‘×™× ×‘××¢×˜×¤×ª ×©×¢×•×–×¨×ª ×œ××”×™×¨×•×ª.",
                    elem: "×™×•×¦×¨ ××™××œ×™×Ÿ ×‘-CNS ×•×›×š ××–×¨×– ×”×•×œ×›×” ×¢×¦×‘×™×ª.",
                    teen: "××œ×›×“ ×¡×’×× ×˜×™× ×œ××•×¨×š ××§×¡×•× ×™× ××¨×•×‘×™×; ×”×•×œ×›×” ××œ×—×™×ª ×‘×™×Ÿ ×’×©×¨×™ ×¨× ×•×™×™×”.",
                    pro: "××™××œ×™× ×™×–×¦×™×” ×“×™× ××™×ª ××•×•×¡×ª×ª ×¢×™×ª×•×™ ×¨×©×ª×•×ª; ×¤×’×™×¢×” ××•×‘×™×œ×” ×œ×™×¨×™×“×” ×‘××”×™×¨×•×ª ×•× ×•×™×¨×•×“×’× ×¨×¦×™×”."
                }
            },
            {
                id: "micro", kind: ["glia", "micro"], title: "××™×§×¨×•×’×œ×™×” ğŸ›¡ï¸",
                tags: ["×—×™×¡×•×Ÿ", "× ×™×§×•×™"],
                text: {
                    kids: "×©×•××¨×™ ×”×™×¢×¨ ×©×œ ×”××•×— â€“ ×× ×§×™× ×•××’× ×™×.",
                    elem: "×ª××™ ×—×™×¡×•×Ÿ ×ª×•×©×‘×™-××•×— ×©××–×”×™× × ×–×§ ×•××¡×™×¨×™× ×¤×¡×•×œ×ª.",
                    teen: "×¤××’×•×¦×™×˜×•×–×”, ×¢×™×¦×•×‘ ××¢×’×œ×™× ×‘×¡×™× ×¤×¡×•×ª, ×¦×™×˜×•×§×™× ×™×.",
                    pro: "××§×•×¨ ×™×•×œ×“×™ ×©×§-×—×œ××•×Ÿ; ××¦×‘×™ M1/M2; ×ª×¨×•××ª× ×œ×”×•×××•×¡×˜×–×™×¡ ×•×œ×¤×ª×•×œ×•×’×™×”."
                }
            },
            {
                id: "schwann", kind: ["glia"], title: "×ª× ×©×•×•××Ÿ ğŸ§µ (PNS)",
                tags: ["××™××œ×™×Ÿ ×¤×¨×™×¤×¨×™", "×ª×™×§×•×Ÿ"],
                text: {
                    kids: "×¢×•×–×¨ ×œ×¢×¦×‘×™× ××—×•×¥ ×œ××•×— ×œ×”×—×œ×™×.",
                    elem: "××™××œ×™×Ÿ ×‘××¢×¨×›×ª ×”×¢×¦×‘×™× ×”×”×™×§×¤×™×ª ×•×ª××™×›×” ×‘×”×ª×—×“×©×•×ª.",
                    teen: "××™××œ×™× ×™×–×¦×™×” ××—×“-×œ××—×“; ×ª×¢×œ×•×ª × ×•×“××œ×™×•×ª.",
                    pro: "×ª×¤×§×™×“×™× ×‘×¨×’× ×¨×¦×™×” ××§×¡×•× ×œ×™×ª, ×”×¤×¨×©×ª ×’×•×¨××™ ×’×“×™×œ×” ×•×”×›×•×•× ×ª × ×‘×™×˜×”."
                }
            }
        ];

        const regions = [
            {
                id: "frontal", kind: ["cortex"], title: "××•× ×” ××¦×—×™×ª ğŸ§­", tags: ["×ª×›× ×•×Ÿ", "×©×œ×™×˜×”"],
                text: { kids: "××¨×›×– ×”×ª×›× ×•×Ÿ â€“ ××—×œ×™×˜ ××” ×¢×•×©×™×.", elem: "×§×‘×œ×ª ×”×—×œ×˜×•×ª, ×©×œ×™×˜×” ×‘×ª× ×•×¢×”, ×ª×›× ×•×Ÿ.", teen: "×ª×¤×§×•×“×™× × ×™×”×•×œ×™×™×, ×§×•×¨×˜×§×¡ ×¤×¨×”-×¤×¨×•× ×˜×œ×™.", pro: "×‘×§×¨×ª ×¢×›×‘×•×ª, ×¢×‘×•×“×” ×‘×–×™×›×¨×•×Ÿ (DLPFC), ××–×•×¨ ××•×˜×•×¨×™ ×¨××©×™ M1." }
            },
            {
                id: "parietal", kind: ["cortex"], title: "××•× ×” ×§×•×“×§×•×“×™×ª ğŸ—ºï¸", tags: ["×—×™×©×”", "××¨×—×‘"],
                text: { kids: "××¨×’×™×©×” ××’×¢ ×•×›×™×•×•×Ÿ.", elem: "×¢×™×‘×•×“ ××’×¢, ×˜××¤×¨×˜×•×¨×” ×•××™×§×•× ×‘××¨×—×‘.", teen: "×©×™×œ×•×‘ ×¡× ×¡×•×¨×™; ×§×©×‘ ××¨×—×‘×™.", pro: "S1, S2 ×¢×™×‘×•×“ ×¡×•××˜×•×¡× ×¡×•×¨×™; ××¤×•×ª ×”×•××•× ×§×•×œ×•×¡." }
            },
            {
                id: "temporal", kind: ["cortex"], title: "××•× ×” ×¨×§×ª×™×ª ğŸµ", tags: ["×©××¢", "×©×¤×”", "×–×™×›×¨×•×Ÿ"],
                text: { kids: "×©×•××¢×ª ×•×¢×•×–×¨×ª ×œ×–×›×•×¨.", elem: "×©××™×¢×” ×•×©×™×•×; ×”×™×¤×•×§××¤×•×¡ ×§×¨×•×‘.", teen: "××–×•×¨×™× ×œ×©×¤×” (×•×•×¨× ×™×§×”); ×§×™×“×•×“ ×–×™×›×¨×•× ×•×ª.", pro: "TL ××“×™××œ×™ ×œ×–×™×›×¨×•×Ÿ ××¤×™×–×•×“×™; ×¢×™×‘×•×“ ××•×“×™×˜×•×¨×™ ×¨××©×•× ×™ A1." }
            },
            {
                id: "occipital", kind: ["cortex"], title: "××•× ×” ×¢×•×¨×¤×™×ª ğŸ‘ï¸", tags: ["×¨××™×™×”"],
                text: { kids: "××¦×™×™×¨×ª ×œ× ×• ××ª ××” ×©×¨×•××™×.", elem: "×¢×™×‘×•×“ ×¨××™×™×ª×™ ×‘×¡×™×¡×™.", teen: "××¡×œ×•×œ×™ ××”/××™×¤×” (ventral/dorsal).", pro: "V1-V5, ××™×¤×•×™ ×¨×˜×™× ×•-×˜×•×¤×™ ×•×–×¨×™××•×ª ××™×“×¢ ×—×–×•×ª×™×•×ª." }
            },
            {
                id: "cerebellum", kind: ["cerebellum"], title: "××•×—×•×Ÿ âš–ï¸", tags: ["××™×–×•×Ÿ", "×“×™×•×§"],
                text: { kids: "×©×•××¨ ×©×œ× × ×ª× ×“× ×“.", elem: "×ª×™××•× ×ª× ×•×¢×” ×•×©×™×•×•×™ ××©×§×œ.", teen: "×§×•××•×¨×“×™× ×¦×™×”, ×œ××™×“×ª ×©×’×™××•×ª.", pro: "××“×¤×˜×¦×™×” ××•×˜×•×¨×™×ª ×“×¨×š Purkinje, ×”×©×•×•××ª ×§×œ×˜×™× ×ª×—×•×©×ª×™×™×." }
            },
            {
                id: "brainstem", kind: ["brainstem"], title: "×’×–×¢ ×”××•×— ğŸŒ¿", tags: ["× ×©×™××”", "×“×•×¤×§"],
                text: { kids: "×“×•××’ ×œ× ×©×•× ×•×œ×¤×¢×•×.", elem: "××¨×›×–×™× ×—×™×•× ×™×™× ×•×©×™×“×•×¨ ××•×ª×•×ª.", teen: "×¤×•×¨××˜×™×• ×¨×˜×™×§×•×œ×¨×™×¡, ××¡×™×œ×•×ª ×¡× ×¡×•-××•×˜×•×¨×™×•×ª.", pro: "×’×¨×¢×™× ×™×, ×¢×¦×‘×™× ×§×¨× ×™××œ×™×™×, ×‘×§×¨×ª ×¢×¨×•×ª ×•×œ×™×‘×” ××•×˜×•× ×•××™×ª." }
            },
            {
                id: "hipp", kind: ["hipp"], title: "×”×™×¤×•×§××¤×•×¡ ğŸ”", tags: ["×–×™×›×¨×•×Ÿ"],
                text: { kids: "×Ö°×¡Ö·×“ÖµÖ¼×¨ ×¡×™×¤×•×¨×™× ×‘×–×™×›×¨×•×Ÿ.", elem: "××¢×‘×™×¨ ×–×™×›×¨×•×Ÿ ×§×¦×¨ ×œ××¨×•×š.", teen: "LTP, ×§×™×“×•×“ ××¨×—×‘×™ ×•× ×•×™×¨×•×’× ×–×”.", pro: "×“× ×˜×™×™×˜ ×’'×™×™×¨×•×¡, CA1/CA3, ×§×•× ×¡×•×œ×™×“×¦×™×” ×•×–×™×›×¨×•×Ÿ ××¨×—×‘×™." }
            },
            {
                id: "amyg", kind: ["amyg"], title: "×××™×’×“×œ×” â¤ï¸â€ğŸ”¥", tags: ["×¨×’×©", "×¡×›× ×”"],
                text: { kids: "×¤×¢××•×Ÿ ×”××–×”×¨×” ×•×”×¨×’×©×•×ª.", elem: "×–×™×”×•×™ ×¤×—×“ ×•×”×‘×¢×•×ª.", teen: "×§×©×™×¨×” ×¨×’×©×™×ª ×œ×–×™×›×¨×•× ×•×ª.", pro: "×’×¨×¢×™× ×™× ×œ×˜×¨××œ×™×™×/×‘×¡×•×œ×˜×¨××œ×™×™×; ××•×“×•×œ×¦×™×™×ª ×ª×’×•×‘×ª ×¡×˜×¨×¡." }
            },
        ];

        const systems = [
            {
                id: "sensory", title: "××¢×¨×›×ª ×—×™×©×” ğŸ‘ƒğŸ‘‚ğŸ‘€", tags: ["×§×œ×™×˜×”", "××’×¢", "×˜×¢×"],
                text: { kids: "×”×—×•×©×™× ××¡×¤×¨×™× ×œ××•×— ××” ×§×•×¨×”.", elem: "×¢×™×‘×•×“ ××™×“×¢ ××—×•×©×™× ×©×•× ×™×.", teen: "××¡×œ×•×œ×™× ×ª×—×•×©×ª×™×™× ×•×¢×œ×™×•× ×•×ª ×§×•×¨×˜×™×§×œ×™×ª.", pro: "×˜×¨× ×¡×“×•×§×¦×™×”, ×§×™×“×•×“, ×•×©×™×œ×•×‘ ×‘×™×Ÿ-×—×•×©×™." }
            },
            {
                id: "motor", title: "××¢×¨×›×ª ×ª× ×•×¢×” ğŸƒ", tags: ["×©×¨×™×¨×™×", "×ª×›× ×•×Ÿ"],
                text: { kids: "××•××¨×ª ×œ×©×¨×™×¨×™× ×œ×–×•×–.", elem: "×××¡×“ ×¤×™×¨××™×“×œ×™ ×•×—×•×¥-×¤×™×¨××™×“×œ×™.", teen: "×’×¨×¢×™× ×™ ×‘×¡×™×¡, ××•×—×•×Ÿ ×•×ª×›× ×•×Ÿ ×ª× ×•×¢×”.", pro: "×ª×›× ×™×•×ª ××•×˜×•×¨×™×•×ª, ×ª×™×§×•×Ÿ ×¤×™×“×‘×§ ×•×”×•×¦××” ×œ×¤×•×¢×œ." }
            },
            {
                id: "memory", title: "××¢×¨×›×ª ×–×™×›×¨×•×Ÿ ğŸ§©", tags: ["×§×™×“×•×“", "×©×œ×™×¤×”"],
                text: { kids: "×–×•×›×¨×ª ×“×‘×¨×™× ×—×©×•×‘×™×.", elem: "×¡×•×’×™ ×–×™×›×¨×•×Ÿ: ×§×¦×¨/××¨×•×š.", teen: "××¤×™×–×•×“×™, ×¡×× ×˜×™, ×¤×¨×•×¦×“×•×¨×œ×™.", pro: "LTP/LTD, ××¢×’×œ×™ ×”×™×¤×•×§××¤×•×¡-×§×œ×™×¤×ª×™×™×." }
            },
            {
                id: "language", title: "×©×¤×” ğŸ—£ï¸", tags: ["×“×™×‘×•×¨", "×”×‘× ×”"],
                text: { kids: "×¢×•×–×¨×ª ×œ× ×• ×œ×“×‘×¨ ×•×œ×”×‘×™×Ÿ.", elem: "××–×•×¨×™× ×œ×©×¤×” ×§×•×¨×˜×™×§×œ×™×ª.", teen: "×‘×¨×•×§×” ××•×œ ×•×•×¨× ×™×§×”.", pro: "×§×™×©×•×¨×™×•×ª ×¤×¨×•× ×˜×•-×˜××¤×•×¨×œ×™×ª ×•×¤×œ×¡×˜×™×•×ª ×œ×©×•× ×™×ª." }
            },
            {
                id: "emotion", title: "×¨×’×© ğŸ’", tags: ["××•×˜×™×‘×¦×™×”", "×ª×’××•×œ"],
                text: { kids: "×œ×”×¨×’×™×© ×©××—×” ××• ×¤×—×“.", elem: "×××™×’×“×œ×” ×•××¢×’×œ ×ª×’××•×œ.", teen: "×“×•×¤××™×Ÿ, ×¡×¨×•×˜×•× ×™×Ÿ ×•×¨×©×ª ×‘×¨×™×¨×ª-××—×“×œ.", pro: "××¢×’×œ ×œ×™××‘×™, VTA-NAc ×•××•×“×•×œ×¦×™×” ×§×•×¨×˜×™×§×œ×™×ª." }
            },
        ];

        const glossary = [
            { term: "×¡×™× ×¤×¡×”", def: "× ×§×•×“×ª ××¤×’×© ×‘×™×Ÿ ×ª××™× ×©×‘×” ××•×¢×‘×¨ ××•×ª ×›×™××™/×—×©××œ×™." },
            { term: "×“× ×“×¨×™×˜", def: "×©×œ×•×—×” ×§×•×œ×˜×ª ×§×œ×˜ ×‘× ×•×™×¨×•×Ÿ." },
            { term: "××§×¡×•×Ÿ", def: "×©×œ×•×—×” ××©×“×¨×ª ×©×œ × ×•×™×¨×•×Ÿ." },
            { term: "××™××œ×™×Ÿ", def: "××¢×˜×¤×ª ×‘×™×“×•×“ ×”×××™×¦×” ×”×•×œ×›×” ×¢×¦×‘×™×ª." },
            { term: "× ×•×™×¨×•×˜×¨× ×¡××™×˜×¨", def: "×—×•××¨ ×›×™××™ ×©××¢×‘×™×¨ ××¡×¨ ×‘×™×Ÿ ×ª××™×." },
        ];

        const experiments = [
            { title: "ğŸ‘€ × ×§×•×“×ª ×¢×™×•×•×¨×•×Ÿ", how: "×¦×™×™×¨×• × ×§×•×“×” ×•×§×• ×¢×œ ×“×£; ×¢×¦×/×™ ×¢×™×Ÿ ××—×ª ×•×”×–×™×–/×™ ××ª ×”×“×£ ×¢×“ ×©×”× ×§×•×“×” × ×¢×œ××ª â€“ ×›×š ××–×”×™× ××ª × ×§×•×“×ª ×”×¢×™×•×•×¨×•×Ÿ." },
            { title: "ğŸ‘‚ ×¨×¤×œ×§×¡ ×¤×™×§×”", how: "×§×™×©×¨×• ×‘×¢×“×™× ×•×ª ××ª×—×ª ×œ×¤×™×§×ª ×”×‘×¨×š (×¢× ×¤×˜×™×© ×’×•××™) ×•×¦×¤×• ×‘×¨×’×œ ×§×•×¤×¦×ª â€“ ××¡×œ×•×œ ×¨×¤×œ×§×¡ ×§×¦×¨." },
            { title: "ğŸ–ï¸ ×”×ª×××ª ××¦×‘×¢-××£", how: "×‘×¢×™× ×™×™× ×¢×¦×•××•×ª × ×¡×• ×œ×’×¢×ª ×‘××£ â€“ ××¨×’×™×©×™× ××ª ×ª×¤×§×™×“ ×”××•×—×•×Ÿ ×‘×“×™×•×§ ×”×ª× ×•×¢×”." },
        ];

        // ---------- STATE ----------
        const state = {
            tab: "cells",
            level: "kids",
            query: "",
            filters: new Set(),
        };

        // ---------- HELPERS ----------
        const $ = s => document.querySelector(s);
        const $$ = s => Array.from(document.querySelectorAll(s));

        function render() {
            // Set level buttons
            $$("[data-level]").forEach(b => b.classList.toggle("active", b.dataset.level === state.level));
            // Set tab selection
            $$(".tab").forEach(t => t.setAttribute("aria-selected", String(t.dataset.tab === state.tab)));

            // Decide dataset
            let data = state.tab === "cells" ? cells : state.tab === "regions" ? regions : state.tab === "systems" ? systems : [];

            // Filters & search
            const q = state.query.toLowerCase();
            data = data.filter(item => {
                const matchesQ = !q || (item.title + " " + (item.tags || []).join(" ") + Object.values(item.text || {}).join(" ")).toLowerCase().includes(q);
                const f = state.filters; if (!f.size) return matchesQ;
                return matchesQ && (item.kind || []).some(k => f.has(k) || f.has(item.id));
            });

            // Build cards
            const frag = document.createDocumentFragment();
            const wrap = document.createElement('div');
            wrap.className = 'kiosk';

            // Extra brain map for regions tab
            $("#mapWrap").hidden = state.tab !== "regions";

            // Cards grid
            const grid = document.createElement('div');
            grid.className = 'cards';

            data.forEach(item => {
                const card = document.createElement('article');
                card.className = 'card';
                const pill = document.createElement('div'); pill.className = 'pill'; pill.textContent = item.tags?.[0] || '××™×“×¢';
                const h = document.createElement('h4'); h.textContent = item.title;
                const p = document.createElement('p'); p.textContent = getText(item);
                const tags = document.createElement('div'); tags.className = 'tags';
                (item.tags || []).forEach(t => { const s = document.createElement('span'); s.className = 'tag'; s.textContent = t; tags.appendChild(s); });
                card.append(pill, h, p, tags);
                grid.appendChild(card);
            });

            // Empty state
            if (!data.length) {
                const empty = document.createElement('div'); empty.className = 'panel';
                empty.innerHTML = '<strong>×œ× × ××¦××• ×ª×•×¦××•×ª.</strong> × ×¡×• ×œ×”×¡×™×¨ ×¡×™× ×•× ×™× ××• ×œ×©× ×•×ª ×’×™×œ.';
                wrap.appendChild(empty);
            }

            wrap.appendChild(grid);
            frag.appendChild(wrap);
            $("#content").replaceChildren(frag);
        }

        function getText(item) {
            const t = item.text || {}; // graceful
            switch (state.level) {
                case 'kids': return t.kids || t.elem || t.teen || t.pro || '';
                case 'elem': return t.elem || t.teen || t.pro || t.kids || '';
                case 'teen': return t.teen || t.pro || t.elem || t.kids || '';
                case 'pro': return t.pro || t.teen || t.elem || t.kids || '';
                default: return t.elem || '';
            }
        }

        // ---------- EVENTS ----------
        // Level selection
        $$("[data-level]").forEach(btn => {
            btn.addEventListener('click', () => { state.level = btn.dataset.level; render(); });
        });

        // Tabs
        $$(".tab").forEach(tab => {
            tab.addEventListener('click', () => { state.tab = tab.dataset.tab; render(); });
        });

        // Filters
        $$("[data-filter]").forEach(btn => {
            btn.addEventListener('click', () => {
                const k = btn.dataset.filter;
                if (state.filters.has(k)) state.filters.delete(k); else state.filters.add(k);
                btn.setAttribute('aria-pressed', String(state.filters.has(k)));
                btn.classList.toggle('active');
                render();
            });
        });

        // Search
        $("#q").addEventListener('input', e => { state.query = e.target.value; render(); });
        $("#clear").addEventListener('click', () => { state.query = ''; $("#q").value = ''; render(); });

        // Brain grid interactions (quick filter)
        $$("#brainGrid .cell").forEach(c => {
            c.addEventListener('click', () => {
                $$("#brainGrid .cell").forEach(x => x.classList.remove('active'));
                c.classList.add('active');
                // map region id to filter or search
                const id = c.dataset.region; state.tab = 'regions'; state.filters = new Set([id]);
                // reflect UI filters
                $$("[data-filter]").forEach(b => { b.classList.toggle('active', state.filters.has(b.dataset.filter)); b.setAttribute('aria-pressed', String(state.filters.has(b.dataset.filter))); });
                render();
            });
        });

        // Dialogs: glossary & experiments
        const dlgGloss = document.getElementById('dlgGloss');
        const dlgExps = document.getElementById('dlgExps');

        $$('[data-open="gloss"]').forEach(b => b.addEventListener('click', () => {
            const body = document.getElementById('glossBody');
            body.innerHTML = glossary.map(g => `<p><strong>${g.term}</strong> â€” ${g.def}</p>`).join('');
            dlgGloss.showModal();
        }));

        $$('[data-open="exps"]').forEach(b => b.addEventListener('click', () => {
            const body = document.getElementById('expsBody');
            body.innerHTML = experiments.map(e => `<p><strong>${e.title}</strong><br>${e.how}</p>`).join('');
            dlgExps.showModal();
        }));

        $$('dialog [data-close]').forEach(b => b.addEventListener('click', e => e.target.closest('dialog').close()));

        // ---------- INIT ----------
        render();
    </script>
</body>

</html>